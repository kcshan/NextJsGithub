{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _Pagination from \"antd/lib/pagination\";\nimport _Col from \"antd/lib/col\";\nimport _List from \"antd/lib/list\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { memo, isValidElement } from 'react';\nimport Router, { withRouter } from 'next/router';\nimport Link from 'next/link';\n\nconst api = require('../lib/api');\n\nimport Repo from '../components/Repo';\nconst LANGUAGES = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python'];\nconst SORT_TYPES = [{\n  name: 'Best Match'\n}, {\n  name: 'Most Stars',\n  value: 'stars',\n  order: 'desc'\n}, {\n  name: 'Fewest Stars',\n  value: 'stars',\n  order: 'asc'\n}, {\n  name: 'Most Forks',\n  value: 'forks',\n  order: 'desc'\n}, {\n  name: 'Fewest Forks',\n  value: 'forks',\n  order: 'asc'\n}];\n/**\n *  sort: 排序方式\n *  order: 排序顺序\n *  lang：仓库的项目开发语言\n *  page: 分页页面\n * */\n\nconst selectedItemStyle = {\n  borderLeft: '2px solid #e36209'\n};\n\nconst noop = () => {};\n\nconst per_page = 20;\nconst FilterLink = memo(({\n  name,\n  query,\n  lang,\n  sort,\n  order,\n  page\n}) => {\n  const doSearch = () => {\n    Router.push({\n      pathname: '/search',\n      query: {\n        query: queryS,\n        lang,\n        sort,\n        order\n      }\n    });\n  };\n\n  let queryString = `?query=${query}`;\n  if (lang) queryString += `&lang=${lang}`;\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`;\n  if (page) queryString += `&page=${page}`;\n  queryString += `&per_page=${per_page}`;\n  return React.createElement(Link, {\n    href: `/search${queryString}`\n  }, isValidElement(name) ? name : React.createElement(\"a\", null, name));\n});\n\nconst Search = ({\n  router,\n  repos\n}) => {\n  const querys = _Object$assign({}, router.query);\n\n  const {\n    lang,\n    sort,\n    order,\n    page\n  } = router.query; // console.log(repos)\n\n  return React.createElement(\"div\", {\n    className: \"jsx-1000625733\" + \" \" + \"root\"\n  }, React.createElement(_Row, {\n    gutter: 20\n  }, React.createElement(_Col, {\n    span: 6\n  }, React.createElement(_List, {\n    bordered: true,\n    header: React.createElement(\"span\", {\n      className: \"jsx-1000625733\" + \" \" + \"list-header\"\n    }, \"\\u8BED\\u8A00\"),\n    style: {\n      marginBottom: 20\n    },\n    dataSource: LANGUAGES,\n    renderItem: item => {\n      const selected = lang === item;\n      return React.createElement(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? React.createElement(\"span\", {\n        className: \"jsx-1000625733\"\n      }, item) : React.createElement(FilterLink, _extends({}, querys, {\n        lang: item,\n        name: item\n      })));\n    }\n  }), React.createElement(_List, {\n    bordered: true,\n    header: React.createElement(\"span\", {\n      className: \"jsx-1000625733\" + \" \" + \"list-header\"\n    }, \"\\u6392\\u5E8F\"),\n    dataSource: SORT_TYPES,\n    renderItem: item => {\n      let selected = false;\n\n      if (item.name === 'Best Match' && !sort) {\n        selected = true;\n      } else if (item.value === sort && item.order === order) {\n        selected = true;\n      }\n\n      return React.createElement(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? React.createElement(\"span\", {\n        className: \"jsx-1000625733\"\n      }, item.name) : React.createElement(FilterLink, _extends({}, querys, {\n        sort: item.value,\n        order: item.order,\n        name: item.name\n      })));\n    }\n  })), React.createElement(_Col, {\n    span: 18\n  }, React.createElement(\"h3\", {\n    className: \"jsx-1000625733\" + \" \" + \"repos-title\"\n  }, repos.total_count, \" \\u4E2A\\u4ED3\\u5E93\"), repos.items.map(repo => React.createElement(Repo, {\n    repo: repo,\n    key: repo.id\n  })), React.createElement(\"div\", {\n    className: \"jsx-1000625733\" + \" \" + \"pagination\"\n  }, React.createElement(_Pagination, {\n    pageSize: per_page,\n    current: Number(page) || 1,\n    total: repos.total_count > 1000 ? 1000 : repos.total_count,\n    onChange: noop,\n    itemRender: (page, type, ol) => {\n      const p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1;\n      const name = type === 'page' ? page : ol;\n      return React.createElement(FilterLink, _extends({}, querys, {\n        page: p,\n        name: name\n      }));\n    }\n  })))), React.createElement(_JSXStyle, {\n    id: \"1000625733\"\n  }, \".root.jsx-1000625733{padding:20px 0;}.list-header.jsx-1000625733{font-weight:800;font-size:16px;}.repos-title.jsx-1000625733{border-bottom:1px solid #eee;font-size:24px;line-height:50px;}.pagination.jsx-1000625733{margin:20px 0;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW5nc2hhc2hhL0Rvd25sb2Fkcy93b3Jrc3BhY2UvY29kaW5nL25vZGVqcy9OZXh0SnNHaXRodWIvbmV4dGpzLXByb2plY3QvcGFnZXMvc2VhcmNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQTZKa0IsQUFHMEIsQUFHQyxBQUlhLEFBS2YsY0FDaEIsQ0FaQSxDQUdpQixhQUlBLEVBSGpCLGFBSW1CLGlCQUNuQiIsImZpbGUiOiIvVXNlcnMveWFuZ3NoYXNoYS9Eb3dubG9hZHMvd29ya3NwYWNlL2NvZGluZy9ub2RlanMvTmV4dEpzR2l0aHViL25leHRqcy1wcm9qZWN0L3BhZ2VzL3NlYXJjaC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1lbW8sIGlzVmFsaWRFbGVtZW50IH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgUm91dGVyLCB7IHdpdGhSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCB7IFJvdywgQ29sLCBMaXN0LCBQYWdpbmF0aW9uIH0gZnJvbSAnYW50ZCdcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluaydcbmNvbnN0IGFwaSA9IHJlcXVpcmUoJy4uL2xpYi9hcGknKVxuXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9jb21wb25lbnRzL1JlcG8nXG5cbmNvbnN0IExBTkdVQUdFUyA9IFsnSmF2YVNjcmlwdCcsICdIVE1MJywgJ0NTUycsICdUeXBlU2NyaXB0JywgJ0phdmEnLCAnUHl0aG9uJ11cbmNvbnN0IFNPUlRfVFlQRVMgPSBbXG4gIHtcbiAgICBuYW1lOiAnQmVzdCBNYXRjaCdcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdNb3N0IFN0YXJzJyxcbiAgICB2YWx1ZTogJ3N0YXJzJyxcbiAgICBvcmRlcjogJ2Rlc2MnXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnRmV3ZXN0IFN0YXJzJyxcbiAgICB2YWx1ZTogJ3N0YXJzJyxcbiAgICBvcmRlcjogJ2FzYydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdNb3N0IEZvcmtzJyxcbiAgICB2YWx1ZTogJ2ZvcmtzJyxcbiAgICBvcmRlcjogJ2Rlc2MnXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnRmV3ZXN0IEZvcmtzJyxcbiAgICB2YWx1ZTogJ2ZvcmtzJyxcbiAgICBvcmRlcjogJ2FzYydcbiAgfVxuXVxuXG4vKipcbiAqICBzb3J0OiDmjpLluo/mlrnlvI9cbiAqICBvcmRlcjog5o6S5bqP6aG65bqPXG4gKiAgbGFuZ++8muS7k+W6k+eahOmhueebruW8gOWPkeivreiogFxuICogIHBhZ2U6IOWIhumhtemhtemdolxuICogKi8gXG5cbmNvbnN0IHNlbGVjdGVkSXRlbVN0eWxlID0ge1xuICBib3JkZXJMZWZ0OiAnMnB4IHNvbGlkICNlMzYyMDknXG59XG5cbmNvbnN0IG5vb3AgPSAoKSA9PiB7fVxuXG5jb25zdCBwZXJfcGFnZSA9IDIwXG5cbmNvbnN0IEZpbHRlckxpbmsgPSBtZW1vKCh7bmFtZSwgcXVlcnksIGxhbmcsIHNvcnQsIG9yZGVyLCBwYWdlfSkgPT4ge1xuICBjb25zdCBkb1NlYXJjaCA9ICgpID0+IHtcbiAgICBSb3V0ZXIucHVzaCh7XG4gICAgICBwYXRobmFtZTogJy9zZWFyY2gnLFxuICAgICAgcXVlcnk6IHtcbiAgICAgICAgcXVlcnk6IHF1ZXJ5UyxcbiAgICAgICAgbGFuZyxcbiAgICAgICAgc29ydCxcbiAgICAgICAgb3JkZXJcbiAgICAgIH1cbiAgICB9KVxuICB9XG4gIGxldCBxdWVyeVN0cmluZyA9IGA/cXVlcnk9JHtxdWVyeX1gXG4gIGlmIChsYW5nKSBxdWVyeVN0cmluZyArPSBgJmxhbmc9JHtsYW5nfWBcbiAgaWYgKHNvcnQpIHF1ZXJ5U3RyaW5nICs9IGAmc29ydD0ke3NvcnR9Jm9yZGVyPSR7b3JkZXIgfHwgJ2Rlc2MnfWBcbiAgaWYgKHBhZ2UpIHF1ZXJ5U3RyaW5nICs9IGAmcGFnZT0ke3BhZ2V9YCBcblxuICBxdWVyeVN0cmluZyArPSBgJnBlcl9wYWdlPSR7cGVyX3BhZ2V9YFxuXG4gIHJldHVybiAoXG4gICAgPExpbmsgaHJlZj17YC9zZWFyY2gke3F1ZXJ5U3RyaW5nfWB9PlxuICAgICAge2lzVmFsaWRFbGVtZW50KG5hbWUpID8gbmFtZSA6IDxhPntuYW1lfTwvYT59XG4gICAgPC9MaW5rPlxuICApXG59KVxuXG5jb25zdCBTZWFyY2ggPSAoeyByb3V0ZXIsIHJlcG9zIH0pID0+IHtcbiAgY29uc3QgeyAuLi5xdWVyeXMgfSA9IHJvdXRlci5xdWVyeVxuICBjb25zdCB7IGxhbmcsIHNvcnQsIG9yZGVyLCBwYWdlIH0gPSByb3V0ZXIucXVlcnlcbiAgLy8gY29uc29sZS5sb2cocmVwb3MpXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJyb290XCI+XG4gICAgICA8Um93IGd1dHRlcj17MjB9PlxuICAgICAgICA8Q29sIHNwYW49ezZ9PlxuICAgICAgICAgIDxMaXN0XG4gICAgICAgICAgICBib3JkZXJlZFxuICAgICAgICAgICAgaGVhZGVyPXs8c3BhbiBjbGFzc05hbWU9XCJsaXN0LWhlYWRlclwiPuivreiogDwvc3Bhbj59XG4gICAgICAgICAgICBzdHlsZT17eyBtYXJnaW5Cb3R0b206IDIwIH19XG4gICAgICAgICAgICBkYXRhU291cmNlPXtMQU5HVUFHRVN9XG4gICAgICAgICAgICByZW5kZXJJdGVtPXtpdGVtID0+IHtcbiAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBsYW5nID09PSBpdGVtXG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxuICAgICAgICAgICAgICAgICAgeyBcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQgPyBcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+e2l0ZW19PC9zcGFuPiA6IFxuICAgICAgICAgICAgICAgICAgICA8RmlsdGVyTGluayBcbiAgICAgICAgICAgICAgICAgICAgICB7Li4ucXVlcnlzfVxuICAgICAgICAgICAgICAgICAgICAgIGxhbmc9e2l0ZW19ICBcbiAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtpdGVtfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9fVxuICAgICAgICAgIC8+XG4gICAgICAgICAgPExpc3RcbiAgICAgICAgICAgIGJvcmRlcmVkXG4gICAgICAgICAgICBoZWFkZXI9ezxzcGFuIGNsYXNzTmFtZT1cImxpc3QtaGVhZGVyXCI+5o6S5bqPPC9zcGFuPn1cbiAgICAgICAgICAgIGRhdGFTb3VyY2U9e1NPUlRfVFlQRVN9XG4gICAgICAgICAgICByZW5kZXJJdGVtPXtpdGVtID0+IHtcbiAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkID0gZmFsc2VcbiAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gJ0Jlc3QgTWF0Y2gnICYmICFzb3J0KSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSB0cnVlXG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS52YWx1ZSA9PT0gc29ydCAmJiBpdGVtLm9yZGVyID09PSBvcmRlcikge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxuICAgICAgICAgICAgICAgIHsgXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZCA/IFxuICAgICAgICAgICAgICAgICAgPHNwYW4+e2l0ZW0ubmFtZX08L3NwYW4+IDogXG4gICAgICAgICAgICAgICAgICA8RmlsdGVyTGluayBcbiAgICAgICAgICAgICAgICAgICAgey4uLnF1ZXJ5c31cbiAgICAgICAgICAgICAgICAgICAgc29ydD17aXRlbS52YWx1ZX0gIFxuICAgICAgICAgICAgICAgICAgICBvcmRlcj17aXRlbS5vcmRlcn0gXG4gICAgICAgICAgICAgICAgICAgIG5hbWU9e2l0ZW0ubmFtZX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9fVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvQ29sPlxuICAgICAgICA8Q29sIHNwYW49ezE4fT5cbiAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJyZXBvcy10aXRsZVwiPntyZXBvcy50b3RhbF9jb3VudH0g5Liq5LuT5bqTPC9oMz5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcmVwb3MuaXRlbXMubWFwKHJlcG8gPT4gKFxuICAgICAgICAgICAgICAgIDxSZXBvIHJlcG89e3JlcG99IGtleT17cmVwby5pZH0gLz5cbiAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnaW5hdGlvblwiPlxuICAgICAgICAgICAgICA8UGFnaW5hdGlvbiBcbiAgICAgICAgICAgICAgICBwYWdlU2l6ZT17cGVyX3BhZ2V9XG4gICAgICAgICAgICAgICAgY3VycmVudD17TnVtYmVyKHBhZ2UpIHx8IDF9XG4gICAgICAgICAgICAgICAgdG90YWw9e3JlcG9zLnRvdGFsX2NvdW50ID4gMTAwMCA/IDEwMDAgOiByZXBvcy50b3RhbF9jb3VudH1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17bm9vcH1cbiAgICAgICAgICAgICAgICBpdGVtUmVuZGVyPXsocGFnZSwgdHlwZSwgb2wpID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSB0eXBlID09PSAncGFnZScgPyBwYWdlIDogdHlwZSA9PT0gJ3ByZXYnID8gcGFnZSAtIDEgOiBwYWdlICsgMVxuICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IHR5cGUgPT09ICdwYWdlJyA/IHBhZ2UgOiBvbFxuICAgICAgICAgICAgICAgICAgcmV0dXJuIDxGaWx0ZXJMaW5rIHsuLi5xdWVyeXN9IHBhZ2U9e3B9IG5hbWU9e25hbWV9IC8+XG4gICAgICAgICAgICAgICAgfX1cblxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvQ29sPlxuICAgICAgPC9Sb3c+XG4gICAgICA8c3R5bGUganN4PntgXG4gICAgICAgIC5yb290IHtcbiAgICAgICAgICBwYWRkaW5nOiAyMHB4IDA7XG4gICAgICAgIH1cbiAgICAgICAgLmxpc3QtaGVhZGVyIHtcbiAgICAgICAgICBmb250LXdlaWdodDogODAwO1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICAgICAgfVxuICAgICAgICAucmVwb3MtdGl0bGUge1xuICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlO1xuICAgICAgICAgIGZvbnQtc2l6ZTogMjRweDtcbiAgICAgICAgICBsaW5lLWhlaWdodDogNTBweDtcbiAgICAgICAgfVxuICAgICAgICAucGFnaW5hdGlvbiB7XG4gICAgICAgICAgbWFyZ2luOiAyMHB4IDA7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5TZWFyY2guZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKHsgY3R4IH0pID0+IHtcbiAgY29uc3QgeyBxdWVyeSwgc29ydCwgbGFuZywgb3JkZXIsIHBhZ2UgfSA9IGN0eC5xdWVyeVxuICBpZiAoIXF1ZXJ5KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlcG9zOiB7XG4gICAgICAgIHRvdGFsX2NvdW50OiAwXG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vID9xPXJlYWN0K2xhbmd1YWdlOmphdmFzY3JpcHQmc29ydD1zdGFycyZvcmRlcj1kZXNjJnBhZ2U9MlxuICBsZXQgcXVlcnlTdHJpbmcgPSBgP3E9JHtxdWVyeX1gXG4gIGlmIChsYW5nKSBxdWVyeVN0cmluZyArPSBgK2xhbmd1YWdlOiR7bGFuZ31gXG4gIGlmIChzb3J0KSBxdWVyeVN0cmluZyArPSBgJnNvcnQ9JHtzb3J0fSZvcmRlcj0ke29yZGVyIHx8ICdkZXNjJ31gXG4gIGlmIChwYWdlKSBxdWVyeVN0cmluZyArPSBgJnBhZ2U9JHtwYWdlfWBcblxuICBxdWVyeVN0cmluZyArPSBgJnBlcl9wYWdlPSR7cGVyX3BhZ2V9YFxuXG4gIFxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcGkucmVxdWVzdChcbiAgICB7XG4gICAgICB1cmw6IGAvc2VhcmNoL3JlcG9zaXRvcmllcyR7cXVlcnlTdHJpbmd9YFxuICAgIH0sIFxuICAgIGN0eC5yZXEsIFxuICAgIGN0eC5yZXNcbiAgKVxuXG4gIHJldHVybiB7XG4gICAgcmVwb3M6IHJlc3VsdC5kYXRhXG4gIH1cbn0gXG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhSb3V0ZXIoU2VhcmNoKSJdfQ== */\\n/*@ sourceURL=/Users/yangshasha/Downloads/workspace/coding/nodejs/NextJsGithub/nextjs-project/pages/search.js */\"));\n};\n\nSearch.getInitialProps = async ({\n  ctx\n}) => {\n  const {\n    query,\n    sort,\n    lang,\n    order,\n    page\n  } = ctx.query;\n\n  if (!query) {\n    return {\n      repos: {\n        total_count: 0\n      }\n    };\n  } // ?q=react+language:javascript&sort=stars&order=desc&page=2\n\n\n  let queryString = `?q=${query}`;\n  if (lang) queryString += `+language:${lang}`;\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`;\n  if (page) queryString += `&page=${page}`;\n  queryString += `&per_page=${per_page}`;\n  const result = await api.request({\n    url: `/search/repositories${queryString}`\n  }, ctx.req, ctx.res);\n  return {\n    repos: result.data\n  };\n};\n\nexport default withRouter(Search);","map":{"version":3,"sources":["/Users/yangshasha/Downloads/workspace/coding/nodejs/NextJsGithub/nextjs-project/pages/search.js"],"names":["memo","isValidElement","Router","withRouter","Link","api","require","Repo","LANGUAGES","SORT_TYPES","name","value","order","selectedItemStyle","borderLeft","noop","per_page","FilterLink","query","lang","sort","page","doSearch","push","pathname","queryS","queryString","Search","router","repos","querys","marginBottom","item","selected","total_count","items","map","repo","id","Number","type","ol","p","getInitialProps","ctx","result","request","url","req","res","data"],"mappings":";;;;;;;;AAAA,SAASA,IAAT,EAAeC,cAAf,QAAqC,OAArC;AACA,OAAOC,MAAP,IAAiBC,UAAjB,QAAmC,aAAnC;AAEA,OAAOC,IAAP,MAAiB,WAAjB;;AACA,MAAMC,GAAG,GAAGC,OAAO,CAAC,YAAD,CAAnB;;AAEA,OAAOC,IAAP,MAAiB,oBAAjB;AAEA,MAAMC,SAAS,GAAG,CAAC,YAAD,EAAe,MAAf,EAAuB,KAAvB,EAA8B,YAA9B,EAA4C,MAA5C,EAAoD,QAApD,CAAlB;AACA,MAAMC,UAAU,GAAG,CACjB;AACEC,EAAAA,IAAI,EAAE;AADR,CADiB,EAIjB;AACEA,EAAAA,IAAI,EAAE,YADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE;AAHT,CAJiB,EASjB;AACEF,EAAAA,IAAI,EAAE,cADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE;AAHT,CATiB,EAcjB;AACEF,EAAAA,IAAI,EAAE,YADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE;AAHT,CAdiB,EAmBjB;AACEF,EAAAA,IAAI,EAAE,cADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE;AAHT,CAnBiB,CAAnB;AA0BA;;;;;;;AAOA,MAAMC,iBAAiB,GAAG;AACxBC,EAAAA,UAAU,EAAE;AADY,CAA1B;;AAIA,MAAMC,IAAI,GAAG,MAAM,CAAE,CAArB;;AAEA,MAAMC,QAAQ,GAAG,EAAjB;AAEA,MAAMC,UAAU,GAAGjB,IAAI,CAAC,CAAC;AAACU,EAAAA,IAAD;AAAOQ,EAAAA,KAAP;AAAcC,EAAAA,IAAd;AAAoBC,EAAAA,IAApB;AAA0BR,EAAAA,KAA1B;AAAiCS,EAAAA;AAAjC,CAAD,KAA4C;AAClE,QAAMC,QAAQ,GAAG,MAAM;AACrBpB,IAAAA,MAAM,CAACqB,IAAP,CAAY;AACVC,MAAAA,QAAQ,EAAE,SADA;AAEVN,MAAAA,KAAK,EAAE;AACLA,QAAAA,KAAK,EAAEO,MADF;AAELN,QAAAA,IAFK;AAGLC,QAAAA,IAHK;AAILR,QAAAA;AAJK;AAFG,KAAZ;AASD,GAVD;;AAWA,MAAIc,WAAW,GAAI,UAASR,KAAM,EAAlC;AACA,MAAIC,IAAJ,EAAUO,WAAW,IAAK,SAAQP,IAAK,EAA7B;AACV,MAAIC,IAAJ,EAAUM,WAAW,IAAK,SAAQN,IAAK,UAASR,KAAK,IAAI,MAAO,EAAtD;AACV,MAAIS,IAAJ,EAAUK,WAAW,IAAK,SAAQL,IAAK,EAA7B;AAEVK,EAAAA,WAAW,IAAK,aAAYV,QAAS,EAArC;AAEA,SACE,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAG,UAASU,WAAY;AAAlC,KACGzB,cAAc,CAACS,IAAD,CAAd,GAAuBA,IAAvB,GAA8B,+BAAIA,IAAJ,CADjC,CADF;AAKD,CAxBsB,CAAvB;;AA0BA,MAAMiB,MAAM,GAAG,CAAC;AAAEC,EAAAA,MAAF;AAAUC,EAAAA;AAAV,CAAD,KAAuB;AACpC,QAAWC,MAAX,sBAAsBF,MAAM,CAACV,KAA7B;;AACA,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,IAAR;AAAcR,IAAAA,KAAd;AAAqBS,IAAAA;AAArB,MAA8BO,MAAM,CAACV,KAA3C,CAFoC,CAGpC;;AACA,SACE;AAAA,wCAAe;AAAf,KACE;AAAK,IAAA,MAAM,EAAE;AAAb,KACE;AAAK,IAAA,IAAI,EAAE;AAAX,KACE;AACE,IAAA,QAAQ,MADV;AAEE,IAAA,MAAM,EAAE;AAAA,0CAAgB;AAAhB,sBAFV;AAGE,IAAA,KAAK,EAAE;AAAEa,MAAAA,YAAY,EAAE;AAAhB,KAHT;AAIE,IAAA,UAAU,EAAEvB,SAJd;AAKE,IAAA,UAAU,EAAEwB,IAAI,IAAI;AAClB,YAAMC,QAAQ,GAAGd,IAAI,KAAKa,IAA1B;AACA,aACE,0BAAM,IAAN;AAAW,QAAA,KAAK,EAAEC,QAAQ,GAAGpB,iBAAH,GAAuB;AAAjD,SAEIoB,QAAQ,GACR;AAAA;AAAA,SAAOD,IAAP,CADQ,GAER,oBAAC,UAAD,eACMF,MADN;AAEE,QAAA,IAAI,EAAEE,IAFR;AAGE,QAAA,IAAI,EAAEA;AAHR,SAJJ,CADF;AAaD;AApBH,IADF,EAuBE;AACE,IAAA,QAAQ,MADV;AAEE,IAAA,MAAM,EAAE;AAAA,0CAAgB;AAAhB,sBAFV;AAGE,IAAA,UAAU,EAAEvB,UAHd;AAIE,IAAA,UAAU,EAAEuB,IAAI,IAAI;AAClB,UAAIC,QAAQ,GAAG,KAAf;;AACA,UAAID,IAAI,CAACtB,IAAL,KAAc,YAAd,IAA8B,CAACU,IAAnC,EAAyC;AACvCa,QAAAA,QAAQ,GAAG,IAAX;AACD,OAFD,MAEO,IAAID,IAAI,CAACrB,KAAL,KAAeS,IAAf,IAAuBY,IAAI,CAACpB,KAAL,KAAeA,KAA1C,EAAiD;AACtDqB,QAAAA,QAAQ,GAAG,IAAX;AACD;;AACD,aACE,0BAAM,IAAN;AAAW,QAAA,KAAK,EAAEA,QAAQ,GAAGpB,iBAAH,GAAuB;AAAjD,SAEEoB,QAAQ,GACR;AAAA;AAAA,SAAOD,IAAI,CAACtB,IAAZ,CADQ,GAER,oBAAC,UAAD,eACMoB,MADN;AAEE,QAAA,IAAI,EAAEE,IAAI,CAACrB,KAFb;AAGE,QAAA,KAAK,EAAEqB,IAAI,CAACpB,KAHd;AAIE,QAAA,IAAI,EAAEoB,IAAI,CAACtB;AAJb,SAJF,CADF;AAcD;AAzBH,IAvBF,CADF,EAoDE;AAAK,IAAA,IAAI,EAAE;AAAX,KACI;AAAA,wCAAc;AAAd,KAA6BmB,KAAK,CAACK,WAAnC,wBADJ,EAGML,KAAK,CAACM,KAAN,CAAYC,GAAZ,CAAgBC,IAAI,IAClB,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAEA,IAAZ;AAAkB,IAAA,GAAG,EAAEA,IAAI,CAACC;AAA5B,IADF,CAHN,EAOI;AAAA,wCAAe;AAAf,KACE;AACE,IAAA,QAAQ,EAAEtB,QADZ;AAEE,IAAA,OAAO,EAAEuB,MAAM,CAAClB,IAAD,CAAN,IAAgB,CAF3B;AAGE,IAAA,KAAK,EAAEQ,KAAK,CAACK,WAAN,GAAoB,IAApB,GAA2B,IAA3B,GAAkCL,KAAK,CAACK,WAHjD;AAIE,IAAA,QAAQ,EAAEnB,IAJZ;AAKE,IAAA,UAAU,EAAE,CAACM,IAAD,EAAOmB,IAAP,EAAaC,EAAb,KAAoB;AAC9B,YAAMC,CAAC,GAAGF,IAAI,KAAK,MAAT,GAAkBnB,IAAlB,GAAyBmB,IAAI,KAAK,MAAT,GAAkBnB,IAAI,GAAG,CAAzB,GAA6BA,IAAI,GAAG,CAAvE;AACA,YAAMX,IAAI,GAAG8B,IAAI,KAAK,MAAT,GAAkBnB,IAAlB,GAAyBoB,EAAtC;AACA,aAAO,oBAAC,UAAD,eAAgBX,MAAhB;AAAwB,QAAA,IAAI,EAAEY,CAA9B;AAAiC,QAAA,IAAI,EAAEhC;AAAvC,SAAP;AACD;AATH,IADF,CAPJ,CApDF,CADF;AAAA;AAAA,6gQADF;AAgGD,CApGD;;AAsGAiB,MAAM,CAACgB,eAAP,GAAyB,OAAO;AAAEC,EAAAA;AAAF,CAAP,KAAmB;AAC1C,QAAM;AAAE1B,IAAAA,KAAF;AAASE,IAAAA,IAAT;AAAeD,IAAAA,IAAf;AAAqBP,IAAAA,KAArB;AAA4BS,IAAAA;AAA5B,MAAqCuB,GAAG,CAAC1B,KAA/C;;AACA,MAAI,CAACA,KAAL,EAAY;AACV,WAAO;AACLW,MAAAA,KAAK,EAAE;AACLK,QAAAA,WAAW,EAAE;AADR;AADF,KAAP;AAKD,GARyC,CAS1C;;;AACA,MAAIR,WAAW,GAAI,MAAKR,KAAM,EAA9B;AACA,MAAIC,IAAJ,EAAUO,WAAW,IAAK,aAAYP,IAAK,EAAjC;AACV,MAAIC,IAAJ,EAAUM,WAAW,IAAK,SAAQN,IAAK,UAASR,KAAK,IAAI,MAAO,EAAtD;AACV,MAAIS,IAAJ,EAAUK,WAAW,IAAK,SAAQL,IAAK,EAA7B;AAEVK,EAAAA,WAAW,IAAK,aAAYV,QAAS,EAArC;AAGA,QAAM6B,MAAM,GAAG,MAAMxC,GAAG,CAACyC,OAAJ,CACnB;AACEC,IAAAA,GAAG,EAAG,uBAAsBrB,WAAY;AAD1C,GADmB,EAInBkB,GAAG,CAACI,GAJe,EAKnBJ,GAAG,CAACK,GALe,CAArB;AAQA,SAAO;AACLpB,IAAAA,KAAK,EAAEgB,MAAM,CAACK;AADT,GAAP;AAGD,CA7BD;;AA+BA,eAAe/C,UAAU,CAACwB,MAAD,CAAzB","sourcesContent":["import { memo, isValidElement } from 'react'\nimport Router, { withRouter } from 'next/router'\nimport { Row, Col, List, Pagination } from 'antd'\nimport Link from 'next/link'\nconst api = require('../lib/api')\n\nimport Repo from '../components/Repo'\n\nconst LANGUAGES = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python']\nconst SORT_TYPES = [\n  {\n    name: 'Best Match'\n  },\n  {\n    name: 'Most Stars',\n    value: 'stars',\n    order: 'desc'\n  },\n  {\n    name: 'Fewest Stars',\n    value: 'stars',\n    order: 'asc'\n  },\n  {\n    name: 'Most Forks',\n    value: 'forks',\n    order: 'desc'\n  },\n  {\n    name: 'Fewest Forks',\n    value: 'forks',\n    order: 'asc'\n  }\n]\n\n/**\n *  sort: 排序方式\n *  order: 排序顺序\n *  lang：仓库的项目开发语言\n *  page: 分页页面\n * */ \n\nconst selectedItemStyle = {\n  borderLeft: '2px solid #e36209'\n}\n\nconst noop = () => {}\n\nconst per_page = 20\n\nconst FilterLink = memo(({name, query, lang, sort, order, page}) => {\n  const doSearch = () => {\n    Router.push({\n      pathname: '/search',\n      query: {\n        query: queryS,\n        lang,\n        sort,\n        order\n      }\n    })\n  }\n  let queryString = `?query=${query}`\n  if (lang) queryString += `&lang=${lang}`\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\n  if (page) queryString += `&page=${page}` \n\n  queryString += `&per_page=${per_page}`\n\n  return (\n    <Link href={`/search${queryString}`}>\n      {isValidElement(name) ? name : <a>{name}</a>}\n    </Link>\n  )\n})\n\nconst Search = ({ router, repos }) => {\n  const { ...querys } = router.query\n  const { lang, sort, order, page } = router.query\n  // console.log(repos)\n  return (\n    <div className=\"root\">\n      <Row gutter={20}>\n        <Col span={6}>\n          <List\n            bordered\n            header={<span className=\"list-header\">语言</span>}\n            style={{ marginBottom: 20 }}\n            dataSource={LANGUAGES}\n            renderItem={item => {\n              const selected = lang === item\n              return (\n                <List.Item style={selected ? selectedItemStyle : null}>\n                  { \n                    selected ? \n                    <span>{item}</span> : \n                    <FilterLink \n                      {...querys}\n                      lang={item}  \n                      name={item}\n                    />\n                  }\n                </List.Item>\n              )\n            }}\n          />\n          <List\n            bordered\n            header={<span className=\"list-header\">排序</span>}\n            dataSource={SORT_TYPES}\n            renderItem={item => {\n              let selected = false\n              if (item.name === 'Best Match' && !sort) {\n                selected = true\n              } else if (item.value === sort && item.order === order) {\n                selected = true\n              }\n              return (\n                <List.Item style={selected ? selectedItemStyle : null}>\n                { \n                  selected ? \n                  <span>{item.name}</span> : \n                  <FilterLink \n                    {...querys}\n                    sort={item.value}  \n                    order={item.order} \n                    name={item.name}\n                  />\n                }\n                </List.Item>\n              )\n            }}\n          />\n        </Col>\n        <Col span={18}>\n            <h3 className=\"repos-title\">{repos.total_count} 个仓库</h3>\n            {\n              repos.items.map(repo => (\n                <Repo repo={repo} key={repo.id} />\n              ))\n            }\n            <div className=\"pagination\">\n              <Pagination \n                pageSize={per_page}\n                current={Number(page) || 1}\n                total={repos.total_count > 1000 ? 1000 : repos.total_count}\n                onChange={noop}\n                itemRender={(page, type, ol) => {\n                  const p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1\n                  const name = type === 'page' ? page : ol\n                  return <FilterLink {...querys} page={p} name={name} />\n                }}\n\n              />\n            </div>\n        </Col>\n      </Row>\n      <style jsx>{`\n        .root {\n          padding: 20px 0;\n        }\n        .list-header {\n          font-weight: 800;\n          font-size: 16px;\n        }\n        .repos-title {\n          border-bottom: 1px solid #eee;\n          font-size: 24px;\n          line-height: 50px;\n        }\n        .pagination {\n          margin: 20px 0;\n        }\n      `}</style>\n    </div>\n  )\n}\n\nSearch.getInitialProps = async ({ ctx }) => {\n  const { query, sort, lang, order, page } = ctx.query\n  if (!query) {\n    return {\n      repos: {\n        total_count: 0\n      }\n    }\n  }\n  // ?q=react+language:javascript&sort=stars&order=desc&page=2\n  let queryString = `?q=${query}`\n  if (lang) queryString += `+language:${lang}`\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\n  if (page) queryString += `&page=${page}`\n\n  queryString += `&per_page=${per_page}`\n\n  \n  const result = await api.request(\n    {\n      url: `/search/repositories${queryString}`\n    }, \n    ctx.req, \n    ctx.res\n  )\n\n  return {\n    repos: result.data\n  }\n} \n\nexport default withRouter(Search)"]},"metadata":{},"sourceType":"module"}