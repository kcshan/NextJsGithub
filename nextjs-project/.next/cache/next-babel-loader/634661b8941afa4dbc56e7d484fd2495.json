{"ast":null,"code":"import _Tabs from \"antd/lib/tabs\";\nimport _Icon from \"antd/lib/icon\";\nimport _Button from \"antd/lib/button\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { useEffect } from 'react';\nimport getConfig from 'next/config';\nimport { connect } from 'react-redux';\nimport Router, { withRouter } from 'next/router';\nimport LRU from 'lru-cache';\nimport Repo from '../components/Repo';\nimport { cacheArray } from '../lib/repo-basic-cache';\n\nconst api = require('../lib/api');\n\nconst {\n  publicRuntimeConfig\n} = getConfig();\nconst cache = new LRU({\n  maxAge: 1000 * 60 * 10\n});\nlet cachedUserRepos, cachedUserStarRepos;\nconst isServer = typeof window === 'undefined';\n\nconst Index = ({\n  userRepos,\n  userStarRepos,\n  user,\n  router\n}) => {\n  const tabKey = router.query.key || '1';\n\n  const handleTabChange = activeKey => {\n    Router.push(`/?key=${activeKey}`);\n  };\n\n  useEffect(() => {\n    if (!isServer) {\n      // 第一种方式\n      // cachedUserRepos = userRepos\n      // cachedUserStarRepos = userStarRepos\n      // const timeout = setTimeout(() => {\n      //   cachedUserRepos = null\n      //   cachedUserStarRepos = null\n      // }, 1000 * 60 * 10);\n      // 第二种方式\n      if (userRepos) {\n        cache.set('userRepos', userRepos);\n      }\n\n      if (userStarRepos) {\n        cache.set('userStarRepos', userStarRepos);\n      }\n    }\n  }, [userRepos, userStarRepos]);\n  useEffect(() => {\n    if (!isServer) {\n      if (userRepos && userStarRepos) {\n        cacheArray(userRepos);\n        cacheArray(userStarRepos);\n      }\n    }\n  });\n\n  if (!user || !user.id) {\n    return React.createElement(\"div\", {\n      className: \"jsx-1516243502\" + \" \" + \"root\"\n    }, React.createElement(\"p\", {\n      className: \"jsx-1516243502\"\n    }, \"\\u4EB2\\uFF0C \\u60A8\\u8FD8\\u6CA1\\u6709\\u767B\\u5F55\\u54E6~\"), React.createElement(_Button, {\n      type: \"primary\",\n      href: publicRuntimeConfig.OAUTH_URL\n    }, \"\\u70B9\\u51FB\\u767B\\u5F55\"), React.createElement(_JSXStyle, {\n      id: \"1516243502\"\n    }, \".root.jsx-1516243502{height:400px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW5nc2hhc2hhL0Rvd25sb2Fkcy93b3Jrc3BhY2UvY29kaW5nL25vZGVqcy9OZXh0SnNHaXRodWIvbmV4dGpzLXByb2plY3QvcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBK0RrQixBQUd3QixhQUNBLDBFQUNTLDhFQUNDLG1HQUNKLDZGQUNyQiIsImZpbGUiOiIvVXNlcnMveWFuZ3NoYXNoYS9Eb3dubG9hZHMvd29ya3NwYWNlL2NvZGluZy9ub2RlanMvTmV4dEpzR2l0aHViL25leHRqcy1wcm9qZWN0L3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcbmltcG9ydCBnZXRDb25maWcgZnJvbSAnbmV4dC9jb25maWcnXG5pbXBvcnQgeyBCdXR0b24sIEljb24sIFRhYnMgfSBmcm9tICdhbnRkJ1xuaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4J1xuaW1wb3J0IFJvdXRlciwgeyB3aXRoUm91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInXG5pbXBvcnQgTFJVIGZyb20gJ2xydS1jYWNoZSdcblxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xuaW1wb3J0IHsgY2FjaGVBcnJheSB9IGZyb20gJy4uL2xpYi9yZXBvLWJhc2ljLWNhY2hlJ1xuXG5jb25zdCBhcGkgPSByZXF1aXJlKCcuLi9saWIvYXBpJylcblxuY29uc3QgeyBwdWJsaWNSdW50aW1lQ29uZmlnIH0gPSBnZXRDb25maWcoKVxuXG5jb25zdCBjYWNoZSA9IG5ldyBMUlUoe1xuICBtYXhBZ2U6IDEwMDAgKiA2MCAqIDEwXG59KVxuXG5sZXQgY2FjaGVkVXNlclJlcG9zLCBjYWNoZWRVc2VyU3RhclJlcG9zXG5cbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcblxuY29uc3QgSW5kZXggPSAoeyB1c2VyUmVwb3MsIHVzZXJTdGFyUmVwb3MsIHVzZXIsIHJvdXRlciB9KSA9PiB7XG5cbiAgY29uc3QgdGFiS2V5ID0gcm91dGVyLnF1ZXJ5LmtleSB8fCAnMSdcblxuICBjb25zdCBoYW5kbGVUYWJDaGFuZ2UgPSAoYWN0aXZlS2V5KSA9PiB7XG4gICAgUm91dGVyLnB1c2goYC8/a2V5PSR7YWN0aXZlS2V5fWApXG4gIH1cblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghaXNTZXJ2ZXIpIHtcbiAgICAgIC8vIOesrOS4gOenjeaWueW8j1xuICAgICAgLy8gY2FjaGVkVXNlclJlcG9zID0gdXNlclJlcG9zXG4gICAgICAvLyBjYWNoZWRVc2VyU3RhclJlcG9zID0gdXNlclN0YXJSZXBvc1xuICAgICAgLy8gY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gICBjYWNoZWRVc2VyUmVwb3MgPSBudWxsXG4gICAgICAvLyAgIGNhY2hlZFVzZXJTdGFyUmVwb3MgPSBudWxsXG4gICAgICAvLyB9LCAxMDAwICogNjAgKiAxMCk7XG4gICAgICAvLyDnrKzkuoznp43mlrnlvI9cbiAgICAgIGlmICh1c2VyUmVwb3MpIHtcbiAgICAgICAgY2FjaGUuc2V0KCd1c2VyUmVwb3MnLCB1c2VyUmVwb3MpXG4gICAgICB9XG4gICAgICBpZiAodXNlclN0YXJSZXBvcykge1xuICAgICAgICBjYWNoZS5zZXQoJ3VzZXJTdGFyUmVwb3MnLCB1c2VyU3RhclJlcG9zKVxuICAgICAgfVxuICAgIH1cbiAgfSwgW3VzZXJSZXBvcywgdXNlclN0YXJSZXBvc10pXG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWlzU2VydmVyKSB7XG4gICAgICBpZiAodXNlclJlcG9zICYmIHVzZXJTdGFyUmVwb3MpIHtcbiAgICAgICAgY2FjaGVBcnJheSh1c2VyUmVwb3MpXG4gICAgICAgIGNhY2hlQXJyYXkodXNlclN0YXJSZXBvcylcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgaWYgKCF1c2VyIHx8ICF1c2VyLmlkKSB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxuICAgICAgPHA+5Lqy77yMIOaCqOi/mOayoeacieeZu+W9leWTpn48L3A+XG4gICAgICA8QnV0dG9uIHR5cGU9XCJwcmltYXJ5XCIgaHJlZj17cHVibGljUnVudGltZUNvbmZpZy5PQVVUSF9VUkx9ID7ngrnlh7vnmbvlvZU8L0J1dHRvbj4gIFxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAucm9vdHtcbiAgICAgICAgICBoZWlnaHQ6IDQwMHB4O1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9kaXY+XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c2VyLWluZm9cIj5cbiAgICAgICAgPGltZyBzcmM9e3VzZXIuYXZhdGFyX3VybH0gYWx0PVwidXNlciBhdmF0YXJcIiBjbGFzc05hbWU9XCJhdmF0YXJcIiAvPlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJsb2dpblwiPnt1c2VyLmxvZ2lufT48L3NwYW4+IFxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJuYW1lXCI+e3VzZXIubmFtZX08L3NwYW4+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImJpb1wiPnt1c2VyLmJpb308L3NwYW4+XG4gICAgICAgIDxwIGNsYXNzTmFtZT1cImVtYWlsXCI+XG4gICAgICAgICAgPEljb24gdHlwZT1cIm1haWxcIiBzdHlsZT17eyBtYXJnaW5SaWdodDogMTAgfX0+PC9JY29uPlxuICAgICAgICAgIDxhIGhyZWY9e2BtYWlsdG86JHt1c2VyLmVtYWlsfWB9Pnt1c2VyLmVtYWlsfTwvYT5cbiAgICAgICAgPC9wPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInVzZXItcmVwb3NcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c2VyLXJlcG9cIj5cbiAgICAgICAgICB7Lyoge1xuICAgICAgICAgICAgdXNlclJlcG9zLm1hcChyZXBvID0+IChcbiAgICAgICAgICAgICAgPFJlcG8gcmVwbz17cmVwb30gLz5cbiAgICAgICAgICAgICkpXG4gICAgICAgICAgfSAqL31cbiAgICAgICAgICA8VGFicyBhY3RpdmVLZXk9e3RhYktleX0gb25DaGFuZ2U9e2hhbmRsZVRhYkNoYW5nZX0gYW5pbWF0ZWQ9e2ZhbHNlfT5cbiAgICAgICAgICAgIDxUYWJzLlRhYlBhbmUgdGFiPVwi5L2g55qE5LuT5bqTXCIga2V5PVwiMVwiPlxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdXNlclJlcG9zLm1hcChyZXBvID0+IChcbiAgICAgICAgICAgICAgICAgIDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz5cbiAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICAgIDxUYWJzLlRhYlBhbmUgdGFiPVwi5L2g5YWz5rOo55qE5LuT5bqTXCIga2V5PVwiMlwiPlxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdXNlclN0YXJSZXBvcy5tYXAocmVwbyA9PiAoXG4gICAgICAgICAgICAgICAgICA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+XG4gICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPC9UYWJzPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAucm9vdHtcbiAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xuICAgICAgICAgIHBhZGRpbmc6IDIwcHggMDtcbiAgICAgICAgfVxuICAgICAgICAudXNlci1pbmZvIHtcbiAgICAgICAgICB3aWR0aDogMjAwcHg7XG4gICAgICAgICAgbWFyZ2luLXJpZ2h0OiA0MHB4O1xuICAgICAgICAgIGZsZXgtc2hyaW5rOiAwO1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgfVxuICAgICAgICAubG9naW57XG4gICAgICAgICAgZm9udC13ZWlnaHQ6IDgwMDtcbiAgICAgICAgICBmb250LXNpemU6IDIwcHg7XG4gICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICAgICAgfVxuICAgICAgICAubmFtZXtcbiAgICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgICAgY29sb3I6ICM3Nzc7XG4gICAgICAgIH1cbiAgICAgICAgLmJpbyB7XG4gICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICAgICAgICBjb2xvcjogIzMzMztcbiAgICAgICAgfVxuICAgICAgICAuYXZhdGFye1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICAgICAgfVxuICAgICAgYH08L3N0eWxlPlxuICAgIDwvZGl2PlxuICApXG59XG5cblxuSW5kZXguZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKHsgY3R4LCByZWR1eFN0b3JlIH0pID0+IHtcblxuICBjb25zdCB1c2VyID0gcmVkdXhTdG9yZS5nZXRTdGF0ZSgpLnVzZXJcbiAgaWYgKCF1c2VyIHx8ICF1c2VyLmlkKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTG9naW46IGZhbHNlXG4gICAgfVxuICB9IFxuXG4gIGlmICghaXNTZXJ2ZXIpIHtcbiAgICAvLyDnrKzkuIDnp43mlrnlvI9cbiAgICAvLyBpZiAoY2FjaGVkVXNlclJlcG9zICYmIGNhY2hlZFVzZXJTdGFyUmVwb3MpIHtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHVzZXJSZXBvczogY2FjaGVkVXNlclJlcG9zLFxuICAgIC8vICAgICB1c2VyU3RhclJlcG9zOiBjYWNoZWRVc2VyU3RhclJlcG9zXG4gICAgLy8gICB9XG4gICAgLy8gfVxuICAgIC8vIOesrOS6jOenjeaWueW8j1xuICAgIGlmIChjYWNoZS5nZXQoJ3VzZXJSZXBvcycpICYmIGNhY2hlLmdldCgndXNlclN0YXJSZXBvcycpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyUmVwb3M6IGNhY2hlLmdldCgndXNlclJlcG9zJyksXG4gICAgICAgIHVzZXJTdGFyUmVwb3M6IGNhY2hlLmdldCgndXNlclN0YXJSZXBvcycpXG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuXG4gIGNvbnN0IHVzZXJSZXBvcyA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxuICAgIHtcbiAgICAgIHVybDogJy91c2VyL3JlcG9zJ1xuICAgIH0sIFxuICAgIGN0eC5yZXEsIFxuICAgIGN0eC5yZXNcbiAgKVxuXG4gIGNvbnN0IHVzZXJTdGFyUmVwb3MgPSBhd2FpdCBhcGkucmVxdWVzdChcbiAgICB7XG4gICAgICB1cmw6ICcvdXNlci9zdGFycmVkJ1xuICAgIH0sIFxuICAgIGN0eC5yZXEsIFxuICAgIGN0eC5yZXNcbiAgKVxuICBcbiAgcmV0dXJuIHtcbiAgICB1c2VyUmVwb3M6IHVzZXJSZXBvcy5kYXRhLFxuICAgIHVzZXJTdGFyUmVwb3M6IHVzZXJTdGFyUmVwb3MuZGF0YSxcbiAgICBpc0xvZ2luOiB0cnVlXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgd2l0aFJvdXRlcihjb25uZWN0KGZ1bmN0aW9uIG1hcFN0YXRlIChzdGF0ZSkge1xuICByZXR1cm4ge1xuICAgIHVzZXI6IHN0YXRlLnVzZXJcbiAgfVxufSkoSW5kZXgpKVxuXG4iXX0= */\\n/*@ sourceURL=/Users/yangshasha/Downloads/workspace/coding/nodejs/NextJsGithub/nextjs-project/pages/index.js */\"));\n  }\n\n  return React.createElement(\"div\", {\n    className: \"jsx-3407872330\" + \" \" + \"root\"\n  }, React.createElement(\"div\", {\n    className: \"jsx-3407872330\" + \" \" + \"user-info\"\n  }, React.createElement(\"img\", {\n    src: user.avatar_url,\n    alt: \"user avatar\",\n    className: \"jsx-3407872330\" + \" \" + \"avatar\"\n  }), React.createElement(\"span\", {\n    className: \"jsx-3407872330\" + \" \" + \"login\"\n  }, user.login, \">\"), React.createElement(\"span\", {\n    className: \"jsx-3407872330\" + \" \" + \"name\"\n  }, user.name), React.createElement(\"span\", {\n    className: \"jsx-3407872330\" + \" \" + \"bio\"\n  }, user.bio), React.createElement(\"p\", {\n    className: \"jsx-3407872330\" + \" \" + \"email\"\n  }, React.createElement(_Icon, {\n    type: \"mail\",\n    style: {\n      marginRight: 10\n    }\n  }), React.createElement(\"a\", {\n    href: `mailto:${user.email}`,\n    className: \"jsx-3407872330\"\n  }, user.email))), React.createElement(\"div\", {\n    className: \"jsx-3407872330\" + \" \" + \"user-repos\"\n  }, React.createElement(\"div\", {\n    className: \"jsx-3407872330\" + \" \" + \"user-repo\"\n  }, React.createElement(_Tabs, {\n    activeKey: tabKey,\n    onChange: handleTabChange,\n    animated: false\n  }, React.createElement(_Tabs.TabPane, {\n    tab: \"\\u4F60\\u7684\\u4ED3\\u5E93\",\n    key: \"1\"\n  }, userRepos.map(repo => React.createElement(Repo, {\n    key: repo.id,\n    repo: repo\n  }))), React.createElement(_Tabs.TabPane, {\n    tab: \"\\u4F60\\u5173\\u6CE8\\u7684\\u4ED3\\u5E93\",\n    key: \"2\"\n  }, userStarRepos.map(repo => React.createElement(Repo, {\n    key: repo.id,\n    repo: repo\n  })))))), React.createElement(_JSXStyle, {\n    id: \"3407872330\"\n  }, \".root.jsx-3407872330{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:20px 0;}.user-info.jsx-3407872330{width:200px;margin-right:40px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.login.jsx-3407872330{font-weight:800;font-size:20px;margin-top:20px;}.name.jsx-3407872330{font-size:16px;color:#777;}.bio.jsx-3407872330{margin-top:20px;color:#333;}.avatar.jsx-3407872330{width:100%;border-radius:5px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW5nc2hhc2hhL0Rvd25sb2Fkcy93b3Jrc3BhY2UvY29kaW5nL25vZGVqcy9OZXh0SnNHaXRodWIvbmV4dGpzLXByb2plY3QvcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBZ0hrQixBQUd3QixBQUtELEFBT0ksQUFLRCxBQUlDLEFBSUwsV0FDTyxDQXBCQSxHQVlQLENBTEksQUFTSixVQUhiLENBSUEsRUFJQSxDQXBCZ0IsQ0FPRSxnQkFDbEIsMkJBZHlCLFlBT1YsMEVBQ1MsdUJBUFAsZUFDakIsd0NBT0EiLCJmaWxlIjoiL1VzZXJzL3lhbmdzaGFzaGEvRG93bmxvYWRzL3dvcmtzcGFjZS9jb2Rpbmcvbm9kZWpzL05leHRKc0dpdGh1Yi9uZXh0anMtcHJvamVjdC9wYWdlcy9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgZ2V0Q29uZmlnIGZyb20gJ25leHQvY29uZmlnJ1xuaW1wb3J0IHsgQnV0dG9uLCBJY29uLCBUYWJzIH0gZnJvbSAnYW50ZCdcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCdcbmltcG9ydCBSb3V0ZXIsIHsgd2l0aFJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJ1xuaW1wb3J0IExSVSBmcm9tICdscnUtY2FjaGUnXG5cbmltcG9ydCBSZXBvIGZyb20gJy4uL2NvbXBvbmVudHMvUmVwbydcbmltcG9ydCB7IGNhY2hlQXJyYXkgfSBmcm9tICcuLi9saWIvcmVwby1iYXNpYy1jYWNoZSdcblxuY29uc3QgYXBpID0gcmVxdWlyZSgnLi4vbGliL2FwaScpXG5cbmNvbnN0IHsgcHVibGljUnVudGltZUNvbmZpZyB9ID0gZ2V0Q29uZmlnKClcblxuY29uc3QgY2FjaGUgPSBuZXcgTFJVKHtcbiAgbWF4QWdlOiAxMDAwICogNjAgKiAxMFxufSlcblxubGV0IGNhY2hlZFVzZXJSZXBvcywgY2FjaGVkVXNlclN0YXJSZXBvc1xuXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnXG5cbmNvbnN0IEluZGV4ID0gKHsgdXNlclJlcG9zLCB1c2VyU3RhclJlcG9zLCB1c2VyLCByb3V0ZXIgfSkgPT4ge1xuXG4gIGNvbnN0IHRhYktleSA9IHJvdXRlci5xdWVyeS5rZXkgfHwgJzEnXG5cbiAgY29uc3QgaGFuZGxlVGFiQ2hhbmdlID0gKGFjdGl2ZUtleSkgPT4ge1xuICAgIFJvdXRlci5wdXNoKGAvP2tleT0ke2FjdGl2ZUtleX1gKVxuICB9XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWlzU2VydmVyKSB7XG4gICAgICAvLyDnrKzkuIDnp43mlrnlvI9cbiAgICAgIC8vIGNhY2hlZFVzZXJSZXBvcyA9IHVzZXJSZXBvc1xuICAgICAgLy8gY2FjaGVkVXNlclN0YXJSZXBvcyA9IHVzZXJTdGFyUmVwb3NcbiAgICAgIC8vIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vICAgY2FjaGVkVXNlclJlcG9zID0gbnVsbFxuICAgICAgLy8gICBjYWNoZWRVc2VyU3RhclJlcG9zID0gbnVsbFxuICAgICAgLy8gfSwgMTAwMCAqIDYwICogMTApO1xuICAgICAgLy8g56ys5LqM56eN5pa55byPXG4gICAgICBpZiAodXNlclJlcG9zKSB7XG4gICAgICAgIGNhY2hlLnNldCgndXNlclJlcG9zJywgdXNlclJlcG9zKVxuICAgICAgfVxuICAgICAgaWYgKHVzZXJTdGFyUmVwb3MpIHtcbiAgICAgICAgY2FjaGUuc2V0KCd1c2VyU3RhclJlcG9zJywgdXNlclN0YXJSZXBvcylcbiAgICAgIH1cbiAgICB9XG4gIH0sIFt1c2VyUmVwb3MsIHVzZXJTdGFyUmVwb3NdKVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFpc1NlcnZlcikge1xuICAgICAgaWYgKHVzZXJSZXBvcyAmJiB1c2VyU3RhclJlcG9zKSB7XG4gICAgICAgIGNhY2hlQXJyYXkodXNlclJlcG9zKVxuICAgICAgICBjYWNoZUFycmF5KHVzZXJTdGFyUmVwb3MpXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG4gIGlmICghdXNlciB8fCAhdXNlci5pZCkge1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cbiAgICAgIDxwPuS6su+8jCDmgqjov5jmsqHmnInnmbvlvZXlk6Z+PC9wPlxuICAgICAgPEJ1dHRvbiB0eXBlPVwicHJpbWFyeVwiIGhyZWY9e3B1YmxpY1J1bnRpbWVDb25maWcuT0FVVEhfVVJMfSA+54K55Ye755m75b2VPC9CdXR0b24+ICBcbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLnJvb3R7XG4gICAgICAgICAgaGVpZ2h0OiA0MDBweDtcbiAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgfVxuICAgICAgYH08L3N0eWxlPlxuICAgIDwvZGl2PlxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidXNlci1pbmZvXCI+XG4gICAgICAgIDxpbWcgc3JjPXt1c2VyLmF2YXRhcl91cmx9IGFsdD1cInVzZXIgYXZhdGFyXCIgY2xhc3NOYW1lPVwiYXZhdGFyXCIgLz5cbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibG9naW5cIj57dXNlci5sb2dpbn0+PC9zcGFuPiBcbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibmFtZVwiPnt1c2VyLm5hbWV9PC9zcGFuPlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJiaW9cIj57dXNlci5iaW99PC9zcGFuPlxuICAgICAgICA8cCBjbGFzc05hbWU9XCJlbWFpbFwiPlxuICAgICAgICAgIDxJY29uIHR5cGU9XCJtYWlsXCIgc3R5bGU9e3sgbWFyZ2luUmlnaHQ6IDEwIH19PjwvSWNvbj5cbiAgICAgICAgICA8YSBocmVmPXtgbWFpbHRvOiR7dXNlci5lbWFpbH1gfT57dXNlci5lbWFpbH08L2E+XG4gICAgICAgIDwvcD5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c2VyLXJlcG9zXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidXNlci1yZXBvXCI+XG4gICAgICAgICAgey8qIHtcbiAgICAgICAgICAgIHVzZXJSZXBvcy5tYXAocmVwbyA9PiAoXG4gICAgICAgICAgICAgIDxSZXBvIHJlcG89e3JlcG99IC8+XG4gICAgICAgICAgICApKVxuICAgICAgICAgIH0gKi99XG4gICAgICAgICAgPFRhYnMgYWN0aXZlS2V5PXt0YWJLZXl9IG9uQ2hhbmdlPXtoYW5kbGVUYWJDaGFuZ2V9IGFuaW1hdGVkPXtmYWxzZX0+XG4gICAgICAgICAgICA8VGFicy5UYWJQYW5lIHRhYj1cIuS9oOeahOS7k+W6k1wiIGtleT1cIjFcIj5cbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHVzZXJSZXBvcy5tYXAocmVwbyA9PiAoXG4gICAgICAgICAgICAgICAgICA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+XG4gICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgICA8VGFicy5UYWJQYW5lIHRhYj1cIuS9oOWFs+azqOeahOS7k+W6k1wiIGtleT1cIjJcIj5cbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHVzZXJTdGFyUmVwb3MubWFwKHJlcG8gPT4gKFxuICAgICAgICAgICAgICAgICAgPFJlcG8ga2V5PXtyZXBvLmlkfSByZXBvPXtyZXBvfSAvPlxuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDwvVGFicz5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLnJvb3R7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDtcbiAgICAgICAgICBwYWRkaW5nOiAyMHB4IDA7XG4gICAgICAgIH1cbiAgICAgICAgLnVzZXItaW5mbyB7XG4gICAgICAgICAgd2lkdGg6IDIwMHB4O1xuICAgICAgICAgIG1hcmdpbi1yaWdodDogNDBweDtcbiAgICAgICAgICBmbGV4LXNocmluazogMDtcbiAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgIH1cbiAgICAgICAgLmxvZ2lue1xuICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7XG4gICAgICAgICAgZm9udC1zaXplOiAyMHB4O1xuICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgIH1cbiAgICAgICAgLm5hbWV7XG4gICAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICAgIGNvbG9yOiAjNzc3O1xuICAgICAgICB9XG4gICAgICAgIC5iaW8ge1xuICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgICAgY29sb3I6ICMzMzM7XG4gICAgICAgIH1cbiAgICAgICAgLmF2YXRhcntcbiAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5cbkluZGV4LmdldEluaXRpYWxQcm9wcyA9IGFzeW5jICh7IGN0eCwgcmVkdXhTdG9yZSB9KSA9PiB7XG5cbiAgY29uc3QgdXNlciA9IHJlZHV4U3RvcmUuZ2V0U3RhdGUoKS51c2VyXG4gIGlmICghdXNlciB8fCAhdXNlci5pZCkge1xuICAgIHJldHVybiB7XG4gICAgICBpc0xvZ2luOiBmYWxzZVxuICAgIH1cbiAgfSBcblxuICBpZiAoIWlzU2VydmVyKSB7XG4gICAgLy8g56ys5LiA56eN5pa55byPXG4gICAgLy8gaWYgKGNhY2hlZFVzZXJSZXBvcyAmJiBjYWNoZWRVc2VyU3RhclJlcG9zKSB7XG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICB1c2VyUmVwb3M6IGNhY2hlZFVzZXJSZXBvcyxcbiAgICAvLyAgICAgdXNlclN0YXJSZXBvczogY2FjaGVkVXNlclN0YXJSZXBvc1xuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICAvLyDnrKzkuoznp43mlrnlvI9cbiAgICBpZiAoY2FjaGUuZ2V0KCd1c2VyUmVwb3MnKSAmJiBjYWNoZS5nZXQoJ3VzZXJTdGFyUmVwb3MnKSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlclJlcG9zOiBjYWNoZS5nZXQoJ3VzZXJSZXBvcycpLFxuICAgICAgICB1c2VyU3RhclJlcG9zOiBjYWNoZS5nZXQoJ3VzZXJTdGFyUmVwb3MnKVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcblxuICBjb25zdCB1c2VyUmVwb3MgPSBhd2FpdCBhcGkucmVxdWVzdChcbiAgICB7XG4gICAgICB1cmw6ICcvdXNlci9yZXBvcydcbiAgICB9LCBcbiAgICBjdHgucmVxLCBcbiAgICBjdHgucmVzXG4gIClcblxuICBjb25zdCB1c2VyU3RhclJlcG9zID0gYXdhaXQgYXBpLnJlcXVlc3QoXG4gICAge1xuICAgICAgdXJsOiAnL3VzZXIvc3RhcnJlZCdcbiAgICB9LCBcbiAgICBjdHgucmVxLCBcbiAgICBjdHgucmVzXG4gIClcbiAgXG4gIHJldHVybiB7XG4gICAgdXNlclJlcG9zOiB1c2VyUmVwb3MuZGF0YSxcbiAgICB1c2VyU3RhclJlcG9zOiB1c2VyU3RhclJlcG9zLmRhdGEsXG4gICAgaXNMb2dpbjogdHJ1ZVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhSb3V0ZXIoY29ubmVjdChmdW5jdGlvbiBtYXBTdGF0ZSAoc3RhdGUpIHtcbiAgcmV0dXJuIHtcbiAgICB1c2VyOiBzdGF0ZS51c2VyXG4gIH1cbn0pKEluZGV4KSlcblxuIl19 */\\n/*@ sourceURL=/Users/yangshasha/Downloads/workspace/coding/nodejs/NextJsGithub/nextjs-project/pages/index.js */\"));\n};\n\nIndex.getInitialProps = async ({\n  ctx,\n  reduxStore\n}) => {\n  const user = reduxStore.getState().user;\n\n  if (!user || !user.id) {\n    return {\n      isLogin: false\n    };\n  }\n\n  if (!isServer) {\n    // 第一种方式\n    // if (cachedUserRepos && cachedUserStarRepos) {\n    //   return {\n    //     userRepos: cachedUserRepos,\n    //     userStarRepos: cachedUserStarRepos\n    //   }\n    // }\n    // 第二种方式\n    if (cache.get('userRepos') && cache.get('userStarRepos')) {\n      return {\n        userRepos: cache.get('userRepos'),\n        userStarRepos: cache.get('userStarRepos')\n      };\n    }\n  }\n\n  const userRepos = await api.request({\n    url: '/user/repos'\n  }, ctx.req, ctx.res);\n  const userStarRepos = await api.request({\n    url: '/user/starred'\n  }, ctx.req, ctx.res);\n  return {\n    userRepos: userRepos.data,\n    userStarRepos: userStarRepos.data,\n    isLogin: true\n  };\n};\n\nexport default withRouter(connect(function mapState(state) {\n  return {\n    user: state.user\n  };\n})(Index));","map":{"version":3,"sources":["/Users/yangshasha/Downloads/workspace/coding/nodejs/NextJsGithub/nextjs-project/pages/index.js"],"names":["useEffect","getConfig","connect","Router","withRouter","LRU","Repo","cacheArray","api","require","publicRuntimeConfig","cache","maxAge","cachedUserRepos","cachedUserStarRepos","isServer","window","Index","userRepos","userStarRepos","user","router","tabKey","query","key","handleTabChange","activeKey","push","set","id","OAUTH_URL","avatar_url","login","name","bio","marginRight","email","map","repo","getInitialProps","ctx","reduxStore","getState","isLogin","get","request","url","req","res","data","mapState","state"],"mappings":"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","sourcesContent":["\nimport { useEffect } from 'react'\nimport getConfig from 'next/config'\nimport { Button, Icon, Tabs } from 'antd'\nimport { connect } from 'react-redux'\nimport Router, { withRouter } from 'next/router'\nimport LRU from 'lru-cache'\n\nimport Repo from '../components/Repo'\nimport { cacheArray } from '../lib/repo-basic-cache'\n\nconst api = require('../lib/api')\n\nconst { publicRuntimeConfig } = getConfig()\n\nconst cache = new LRU({\n  maxAge: 1000 * 60 * 10\n})\n\nlet cachedUserRepos, cachedUserStarRepos\n\nconst isServer = typeof window === 'undefined'\n\nconst Index = ({ userRepos, userStarRepos, user, router }) => {\n\n  const tabKey = router.query.key || '1'\n\n  const handleTabChange = (activeKey) => {\n    Router.push(`/?key=${activeKey}`)\n  }\n\n  useEffect(() => {\n    if (!isServer) {\n      // 第一种方式\n      // cachedUserRepos = userRepos\n      // cachedUserStarRepos = userStarRepos\n      // const timeout = setTimeout(() => {\n      //   cachedUserRepos = null\n      //   cachedUserStarRepos = null\n      // }, 1000 * 60 * 10);\n      // 第二种方式\n      if (userRepos) {\n        cache.set('userRepos', userRepos)\n      }\n      if (userStarRepos) {\n        cache.set('userStarRepos', userStarRepos)\n      }\n    }\n  }, [userRepos, userStarRepos])\n\n  useEffect(() => {\n    if (!isServer) {\n      if (userRepos && userStarRepos) {\n        cacheArray(userRepos)\n        cacheArray(userStarRepos)\n      }\n    }\n  })\n\n  if (!user || !user.id) {\n    return <div className=\"root\">\n      <p>亲， 您还没有登录哦~</p>\n      <Button type=\"primary\" href={publicRuntimeConfig.OAUTH_URL} >点击登录</Button>  \n      <style jsx>{`\n        .root{\n          height: 400px;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n        }\n      `}</style>\n    </div>\n  }\n\n  return (\n    <div className=\"root\">\n      <div className=\"user-info\">\n        <img src={user.avatar_url} alt=\"user avatar\" className=\"avatar\" />\n        <span className=\"login\">{user.login}></span> \n        <span className=\"name\">{user.name}</span>\n        <span className=\"bio\">{user.bio}</span>\n        <p className=\"email\">\n          <Icon type=\"mail\" style={{ marginRight: 10 }}></Icon>\n          <a href={`mailto:${user.email}`}>{user.email}</a>\n        </p>\n      </div>\n      <div className=\"user-repos\">\n        <div className=\"user-repo\">\n          {/* {\n            userRepos.map(repo => (\n              <Repo repo={repo} />\n            ))\n          } */}\n          <Tabs activeKey={tabKey} onChange={handleTabChange} animated={false}>\n            <Tabs.TabPane tab=\"你的仓库\" key=\"1\">\n              {\n                userRepos.map(repo => (\n                  <Repo key={repo.id} repo={repo} />\n                ))\n              }\n            </Tabs.TabPane>\n            <Tabs.TabPane tab=\"你关注的仓库\" key=\"2\">\n              {\n                userStarRepos.map(repo => (\n                  <Repo key={repo.id} repo={repo} />\n                ))\n              }\n            </Tabs.TabPane>\n          </Tabs>\n        </div>\n      </div>\n      <style jsx>{`\n        .root{\n          display: flex;\n          align-items: flex-start;\n          padding: 20px 0;\n        }\n        .user-info {\n          width: 200px;\n          margin-right: 40px;\n          flex-shrink: 0;\n          display: flex;\n          flex-direction: column;\n        }\n        .login{\n          font-weight: 800;\n          font-size: 20px;\n          margin-top: 20px;\n        }\n        .name{\n          font-size: 16px;\n          color: #777;\n        }\n        .bio {\n          margin-top: 20px;\n          color: #333;\n        }\n        .avatar{\n          width: 100%;\n          border-radius: 5px;\n        }\n      `}</style>\n    </div>\n  )\n}\n\n\nIndex.getInitialProps = async ({ ctx, reduxStore }) => {\n\n  const user = reduxStore.getState().user\n  if (!user || !user.id) {\n    return {\n      isLogin: false\n    }\n  } \n\n  if (!isServer) {\n    // 第一种方式\n    // if (cachedUserRepos && cachedUserStarRepos) {\n    //   return {\n    //     userRepos: cachedUserRepos,\n    //     userStarRepos: cachedUserStarRepos\n    //   }\n    // }\n    // 第二种方式\n    if (cache.get('userRepos') && cache.get('userStarRepos')) {\n      return {\n        userRepos: cache.get('userRepos'),\n        userStarRepos: cache.get('userStarRepos')\n      }\n    }\n  }\n  \n\n  const userRepos = await api.request(\n    {\n      url: '/user/repos'\n    }, \n    ctx.req, \n    ctx.res\n  )\n\n  const userStarRepos = await api.request(\n    {\n      url: '/user/starred'\n    }, \n    ctx.req, \n    ctx.res\n  )\n  \n  return {\n    userRepos: userRepos.data,\n    userStarRepos: userStarRepos.data,\n    isLogin: true\n  }\n}\n\nexport default withRouter(connect(function mapState (state) {\n  return {\n    user: state.user\n  }\n})(Index))\n\n"]},"metadata":{},"sourceType":"module"}