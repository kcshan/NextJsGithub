{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _Object$entries from \"@babel/runtime-corejs2/core-js/object/entries\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { useEffect } from 'react';\nimport Link from 'next/link';\nimport { withRouter } from 'next/router';\nimport Repo from './repo';\nimport api from '../lib/api';\nimport { get, cache } from '../lib/repo-basic-cache';\nvar isServer = typeof window === 'undefined';\nexport default (function (Comp) {\n  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'index';\n\n  var makeQuery = function makeQuery(queryObject) {\n    var query = _Object$entries(queryObject).reduce(function (result, entry) {\n      result.push(entry.join('='));\n      return result;\n    }, []).join('&');\n\n    return \"?\".concat(query);\n  };\n\n  var WithDetail = function WithDetail(_ref) {\n    var router = _ref.router,\n        repoBasic = _ref.repoBasic,\n        rest = _objectWithoutProperties(_ref, [\"router\", \"repoBasic\"]);\n\n    var query = makeQuery(router.query);\n    useEffect(function () {\n      if (!isServer) {\n        cache(repoBasic);\n      }\n    });\n    return React.createElement(\"div\", {\n      className: \"jsx-1251108973\" + \" \" + \"root\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-1251108973\" + \" \" + \"repo-basic\"\n    }, React.createElement(Repo, {\n      repo: repoBasic\n    }), React.createElement(\"div\", {\n      className: \"jsx-1251108973\" + \" \" + \"tabs\"\n    }, type === 'index' ? React.createElement(\"span\", {\n      className: \"jsx-1251108973\" + \" \" + \"tab\"\n    }, \"Readme\") : React.createElement(Link, {\n      href: \"/detail\".concat(query)\n    }, React.createElement(\"a\", {\n      className: \"jsx-1251108973\" + \" \" + \"tab index\"\n    }, \"Readme\")), type === 'issues' ? React.createElement(\"span\", {\n      className: \"jsx-1251108973\" + \" \" + \"tab\"\n    }, \"Issues\") : React.createElement(Link, {\n      href: \"/detail/issues\".concat(query)\n    }, React.createElement(\"a\", {\n      className: \"jsx-1251108973\" + \" \" + \"tab issues\"\n    }, \"Issues\")))), React.createElement(\"div\", {\n      className: \"jsx-1251108973\"\n    }, React.createElement(Comp, rest)), React.createElement(_JSXStyle, {\n      id: \"1251108973\"\n    }, \".root.jsx-1251108973{padding-top:20px;}.repo-basic.jsx-1251108973{padding:20px;border:1px solid #eee;margin-bottom:20px;border-radius:5px;}.tab.jsx-1251108973+.tab.jsx-1251108973{margin-left:20px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW5nc2hhc2hhL0Rvd25sb2Fkcy93b3Jrc3BhY2UvY29kaW5nL25vZGVqcy9OZXh0SnNHaXRodWIvbmV4dGpzLXByb2plY3QvY29tcG9uZW50cy9XaXRoUmVwb0Jhc2ljLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxRG9CLEFBRzhCLEFBR0osQUFNSSxhQUxLLElBSHhCLEFBU0Esa0JBTHFCLG1CQUNELGtCQUNwQiIsImZpbGUiOiIvVXNlcnMveWFuZ3NoYXNoYS9Eb3dubG9hZHMvd29ya3NwYWNlL2NvZGluZy9ub2RlanMvTmV4dEpzR2l0aHViL25leHRqcy1wcm9qZWN0L2NvbXBvbmVudHMvV2l0aFJlcG9CYXNpYy5qc3giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluaydcbmltcG9ydCB7IHdpdGhSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCBSZXBvIGZyb20gJy4vcmVwbydcbmltcG9ydCBhcGkgZnJvbSAnLi4vbGliL2FwaSdcbmltcG9ydCB7IGdldCwgY2FjaGUgfSBmcm9tICcuLi9saWIvcmVwby1iYXNpYy1jYWNoZSdcblxuY29uc3QgaXNTZXJ2ZXIgPSB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJ1xuXG5leHBvcnQgZGVmYXVsdCAoQ29tcCwgdHlwZSA9ICdpbmRleCcpID0+IHtcblxuICBjb25zdCBtYWtlUXVlcnkgPSAocXVlcnlPYmplY3QpID0+IHtcbiAgICBjb25zdCBxdWVyeSA9IE9iamVjdC5lbnRyaWVzKHF1ZXJ5T2JqZWN0KVxuICAgIC5yZWR1Y2UoKHJlc3VsdCwgZW50cnkpID0+IHtcbiAgICAgIHJlc3VsdC5wdXNoKGVudHJ5LmpvaW4oJz0nKSlcbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9LCBbXSkuam9pbignJicpXG4gICAgcmV0dXJuIGA/JHtxdWVyeX1gXG4gIH1cblxuICBjb25zdCBXaXRoRGV0YWlsID0gKHsgcm91dGVyLCByZXBvQmFzaWMsIC4uLnJlc3QgfSkgPT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gbWFrZVF1ZXJ5KHJvdXRlci5xdWVyeSlcbiAgXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmICghaXNTZXJ2ZXIpIHtcbiAgICAgICAgY2FjaGUocmVwb0Jhc2ljKVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlcG8tYmFzaWNcIj5cbiAgICAgICAgICA8UmVwbyByZXBvPXtyZXBvQmFzaWN9IC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJzXCI+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR5cGUgPT09ICdpbmRleCcgPyBcbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGFiXCI+UmVhZG1lPC9zcGFuPiA6XG4gICAgICAgICAgICAgIDxMaW5rIGhyZWY9e2AvZGV0YWlsJHtxdWVyeX1gfT5cbiAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJ0YWIgaW5kZXhcIj5SZWFkbWU8L2E+XG4gICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdHlwZSA9PT0gJ2lzc3VlcycgPyBcbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGFiXCI+SXNzdWVzPC9zcGFuPiA6XG4gICAgICAgICAgICAgIDxMaW5rIGhyZWY9e2AvZGV0YWlsL2lzc3VlcyR7cXVlcnl9YH0+XG4gICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwidGFiIGlzc3Vlc1wiPklzc3VlczwvYT5cbiAgICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8Q29tcCB7Li4ucmVzdH0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgICAucm9vdCB7XG4gICAgICAgICAgICBwYWRkaW5nLXRvcDogMjBweDtcbiAgICAgICAgICB9ICBcbiAgICAgICAgICAucmVwby1iYXNpYyB7XG4gICAgICAgICAgICBwYWRkaW5nOiAyMHB4O1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2VlZTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7XG4gICAgICAgICAgfVxuICAgICAgICAgIC50YWIgKyAudGFiIHtcbiAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAyMHB4O1xuICAgICAgICAgIH1cbiAgICAgICAgYH08L3N0eWxlPlxuICAgICAgPC9kaXY+XG4gICAgKVxuICB9XG4gIFdpdGhEZXRhaWwuZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKGNvbnRleHQpID0+IHtcblxuICAgIGNvbnN0IHsgcm91dGVyLCBjdHggfSA9IGNvbnRleHQgXG4gICAgY29uc3QgeyBvd25lciwgbmFtZSB9ID0gY3R4LnF1ZXJ5XG5cbiAgICBjb25zdCBmdWxsX25hbWUgPSBgJHtvd25lcn0vJHtuYW1lfWBcbiAgXG4gICAgbGV0IHBhZ2VEYXRhID0ge31cbiAgICBpZiAoQ29tcC5nZXRJbml0aWFsUHJvcHMpIHtcbiAgICAgIHBhZ2VEYXRhID0gYXdhaXQgQ29tcC5nZXRJbml0aWFsUHJvcHMoY29udGV4dClcbiAgICB9XG5cbiAgICBpZiAoZ2V0KGZ1bGxfbmFtZSkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlcG9CYXNpYzogZ2V0KGZ1bGxfbmFtZSksXG4gICAgICAgIC4uLnBhZ2VEYXRhXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmVwb0Jhc2ljID0gYXdhaXQgYXBpLnJlcXVlc3QoXG4gICAgICB7XG4gICAgICAgIHVybDogYC9yZXBvcy8ke293bmVyfS8ke25hbWV9YCxcbiAgICAgIH0sXG4gICAgICBjdHgucmVxLFxuICAgICAgY3R4LnJlc1xuICAgIClcblxuICAgIFxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlcG9CYXNpYzogcmVwb0Jhc2ljLmRhdGEsXG4gICAgICAuLi5wYWdlRGF0YVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB3aXRoUm91dGVyKFdpdGhEZXRhaWwpXG59Il19 */\\n/*@ sourceURL=/Users/yangshasha/Downloads/workspace/coding/nodejs/NextJsGithub/nextjs-project/components/WithRepoBasic.jsx */\"));\n  };\n\n  WithDetail.getInitialProps =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(context) {\n      var router, ctx, _ctx$query, owner, name, full_name, pageData, repoBasic;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              router = context.router, ctx = context.ctx;\n              _ctx$query = ctx.query, owner = _ctx$query.owner, name = _ctx$query.name;\n              full_name = \"\".concat(owner, \"/\").concat(name);\n              pageData = {};\n\n              if (!Comp.getInitialProps) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.next = 7;\n              return Comp.getInitialProps(context);\n\n            case 7:\n              pageData = _context.sent;\n\n            case 8:\n              if (!get(full_name)) {\n                _context.next = 10;\n                break;\n              }\n\n              return _context.abrupt(\"return\", _objectSpread({\n                repoBasic: get(full_name)\n              }, pageData));\n\n            case 10:\n              _context.next = 12;\n              return api.request({\n                url: \"/repos/\".concat(owner, \"/\").concat(name)\n              }, ctx.req, ctx.res);\n\n            case 12:\n              repoBasic = _context.sent;\n              return _context.abrupt(\"return\", _objectSpread({\n                repoBasic: repoBasic.data\n              }, pageData));\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return withRouter(WithDetail);\n});","map":{"version":3,"sources":["/Users/yangshasha/Downloads/workspace/coding/nodejs/NextJsGithub/nextjs-project/components/WithRepoBasic.jsx"],"names":["useEffect","Link","withRouter","Repo","api","get","cache","isServer","window","Comp","type","makeQuery","queryObject","query","reduce","result","entry","push","join","WithDetail","router","repoBasic","rest","getInitialProps","context","ctx","owner","name","full_name","pageData","request","url","req","res","data"],"mappings":"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","sourcesContent":["import { useEffect } from 'react'\nimport Link from 'next/link'\nimport { withRouter } from 'next/router'\nimport Repo from './repo'\nimport api from '../lib/api'\nimport { get, cache } from '../lib/repo-basic-cache'\n\nconst isServer = typeof window === 'undefined'\n\nexport default (Comp, type = 'index') => {\n\n  const makeQuery = (queryObject) => {\n    const query = Object.entries(queryObject)\n    .reduce((result, entry) => {\n      result.push(entry.join('='))\n      return result\n    }, []).join('&')\n    return `?${query}`\n  }\n\n  const WithDetail = ({ router, repoBasic, ...rest }) => {\n    const query = makeQuery(router.query)\n  \n    useEffect(() => {\n      if (!isServer) {\n        cache(repoBasic)\n      }\n    })\n    \n    return (\n      <div className=\"root\">\n        <div className=\"repo-basic\">\n          <Repo repo={repoBasic} />\n          <div className=\"tabs\">\n            {\n              type === 'index' ? \n              <span className=\"tab\">Readme</span> :\n              <Link href={`/detail${query}`}>\n                <a className=\"tab index\">Readme</a>\n              </Link>\n            }\n            {\n              type === 'issues' ? \n              <span className=\"tab\">Issues</span> :\n              <Link href={`/detail/issues${query}`}>\n                <a className=\"tab issues\">Issues</a>\n              </Link>\n            }\n          </div>\n        </div>\n        <div>\n          <Comp {...rest} />\n        </div>\n        <style jsx>{`\n          .root {\n            padding-top: 20px;\n          }  \n          .repo-basic {\n            padding: 20px;\n            border: 1px solid #eee;\n            margin-bottom: 20px;\n            border-radius: 5px;\n          }\n          .tab + .tab {\n            margin-left: 20px;\n          }\n        `}</style>\n      </div>\n    )\n  }\n  WithDetail.getInitialProps = async (context) => {\n\n    const { router, ctx } = context \n    const { owner, name } = ctx.query\n\n    const full_name = `${owner}/${name}`\n  \n    let pageData = {}\n    if (Comp.getInitialProps) {\n      pageData = await Comp.getInitialProps(context)\n    }\n\n    if (get(full_name)) {\n      return {\n        repoBasic: get(full_name),\n        ...pageData\n      }\n    }\n\n    const repoBasic = await api.request(\n      {\n        url: `/repos/${owner}/${name}`,\n      },\n      ctx.req,\n      ctx.res\n    )\n\n    \n\n    return {\n      repoBasic: repoBasic.data,\n      ...pageData\n    }\n  }\n\n  return withRouter(WithDetail)\n}"]},"metadata":{},"sourceType":"module"}